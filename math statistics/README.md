# Математическая статистика

## **О предмете**

В курсе рассматриваются статистические методы и задачи, непосредственным образом связанные с обработкой и анализом данных, а именно: описательные статистики, точечные и интервальные оценки параметров, проверка статистических гипотез, линейные статистические модели.

Продолжительность: 1 семестр.

## **Лабораторные работы**
![Jupiter Notebook](https://github.com/kihort-si/itmo/blob/main/common/jupiter.svg)

### [**Лабораторная работа №1**](https://github.com/kihort-si/itmo/tree/main/math%20statistics/lab%201)

#### Задание 1

В файле [`sex_bmi_smokers.csv`](https://github.com/kihort-si/itmo/blob/main/math%20statistics/lab%201/sex_bmi_smokers.csv) приведены данные (пол, ИМТ, курит/не курит) о более 1000 испытуемых. Сравните количество курящих мужчин и некурящих женщин. Рассчитайте выборочное среднее, выборочную дисперсию, выборочную медиану, выборочную квантиль порядка 3/5 ИМТ всех наблюдателей и отдельно для каждой возможной комбинации пол-курение. Постройте график эмпирической функции распределения, гистограмму, box-plot ИМТ для всех наблюдателей, отдельно для каждой возможной комбинации пол-курение.

#### Задание 2

Предположите, какому вероятностному закону соответствует распределение показателя, рассмотренного (расчёт выборочных характеристик и визуализация) в задании №1. Оцените параметры данного распределения методом: максимального правдоподобия, или методом моментов **(математическое обоснование оценки строго обязательно)**. Какими статистическими свойствами обладает найденная оценка (**обосновать**)? Найти **теоретические** смещение исперсию, MSE *(или хотя бы написать теоретические формулы, по которым данные показатели вычисляются, если в итоге получается «очень сложный» интеграл/ряд)*, информацию Фишера (если определена для вашей модели).

#### Задание 3

Пусть $ P_\theta $ — выбранное в предыдущем задании распределение, параметризующееся вектором $\theta$   
*(пример — равномерное распределение на $[-2\theta; 4\theta], \hat{\theta} = \bar{X}$*.

$\hat{\theta}$ — оценка параметра $\theta$, полученная в предыдущем упражнении.  
Проведите численный эксперимент по следующей схеме:

- Зафиксируйте конкретное значение $\theta = \theta_0$ 
- Заведите массив $\{n_1, \dots, n_k\}$ объёмов выборки
- Сгенерируйте из распределения $P_{\theta_0}$ достаточно большое количество $M$ выборок объёма $n$, где $n$ принимает значения из массива $\{n_1, \dots, n_m\}$. Для каждой сгенерированной выборки вычислите $\hat{\theta}$

- Эмпирически рассмотрите поведение оценки $\hat{\theta}$ в зависимости от объёма выборки *(можно для каждого объёма выборки $n_i$ вывести описательные статистики для оценок, изобразить гистограмму, box-plot, violin-plot)*.

### [**Лабораторная работа №2**](https://github.com/kihort-si/itmo/tree/main/math%20statistics/lab%202)

#### Задание 1

Для выполнения первого упражнения будут весьма полезными знания об определении распределения хи-квадрат, Стьюдента и Фишера. Плюс теорема Фишера для выборок из нормального закона.

Предъявите доверительный интервал уровня $1 - \alpha$ для указанного параметра при данных предположениях (**с математическими обоснованиями**). Сгенерируйте 2 выборки объёма 25 и посчитайте доверительный интервал. Повторить 1000 раз. Посчитайте, сколько раз 95-процентный доверительный интервал покрывает реальное значение параметра. То же самое сделайте для объема выборки 10000. Как изменился результат? Как объяснить? Что изменяется при росте объемов выборок?

Задача представлена в 4 вариантах. Везде даны две независимые выборки $X_1, X_2$ из нормальных распределений 
$\mathcal{N}(\mu_1, \sigma_1^2), \mathcal{N}(\mu_2, \sigma_2^2)$ объемов $n_1, n_2$ соответственно. Сначала указывается оцениваемая функция, потом данные об остальных параметрах, затем параметры эксперимента и подсказки.

$$
\tau = \frac{\sigma_1^2}{\sigma_2^2};\quad \mu_1, \mu_2 \text{ известны};\quad \mu_1 = 0,\; \mu_2 = 0,\; \sigma_1^2 = 2,\; \sigma_2^2 = 1;
$$

воспользуйтесь функцией:

$$
\frac
{n_2 \sum\limits_{i=1}^{n_1} (X_{1,i} - \mu_1)^2}
{n_1 \sum\limits_{i=1}^{n_2} (X_{2,i} - \mu_2)^2}
\cdot \frac{\sigma_2^2}{\sigma_1^2}
$$

#### Задание 2

В данном упражнении для построения асимптотического доверительного интервала весьма полезным будет применение ЦПТ к самой выборке или некоторому преобразованию выборки (например, к $X^2$).

Постройте асимптотический доверительный интервал уровня $1 - \alpha$ для указанного параметра. Проведите эксперимент по схеме, аналогичной первой задаче.

Задача представлена в 5 вариантах. Сначала указывается класс распределений (однопараметрический), затем параметры эксперимента и подсказки.

$\mathrm{Exp}(\lambda) $; медиана; $ \lambda = 1 $

### [**Лабораторная работа №3**](https://github.com/kihort-si/itmo/tree/main/math%20statistics/lab%203)

Для каждой проблемы нужно провести два статистических теста, если не сказано иное, причем первый из критериев нужно реализовать самостоятельно (считать и выводить значение статистики, критическое значение, p-value), в качестве второго можно воспользоваться готовой реализацией. Также нужно отдельно указывать, как формализуются $H_0$ и $H_1$ для выбранных тестов. Уровень значимости выбираете сами.

В датасете [датасете](https://github.com/kihort-si/itmo/blob/main/math%20statistics/lab%203/mobile_phones.csv) приведены данные о мобильных телефонах.

1. Предположите, с каким вероятностным законом распределена емкость аккумулятора. С помощью стат. теста подтвердите/опровергните это предположение (первый тест – критерий согласия Колмогорова, если распределение абсолютно непрерывное, либо критерий согласия Пирсона хи-квадрат, если распределение дискретное).

2. Верно ли, что распределение у емкости аккумулятора среди поддерживающих/не поддерживающих Wi-Fi одинаково (первый тест – критерий однородности Смирнова или хи-квадрат, или f-test + t-test)?

3. Верно ли, что при увеличении емкости аккумулятора растет цена (первый тест – критерий на один из коэффициентов корреляции)?

### [**Лабораторная работа №4**](https://github.com/kihort-si/itmo/tree/main/math%20statistics/lab%204)

#### Задание 1

Задание представлено в 4 вариантах. Для каждого варианта требуется построить линейную модель (предполагая нормальность распределения ошибок с нулевым средним, некоррелированность компонент, гомоскедастичность), вычислить оценки коэффициентов модели и остаточной дисперсии, построить для них доверительные интервалы, вычислить коэффициент детерминации, проверить указанные в условии гипотезы с помощью построенной линейной модели.

**Указание:** из встроенных функций разрешается пользоваться квантильными функциями и средствами для квадратичной оптимизации (иными словами, готовую обёртку для построения линейной модели не использовать, максимум можете сравнить вашу реализацию с готовой).

В [файле](https://github.com/kihort-si/itmo/blob/main/math%20statistics/lab%204/kc_house_data.csv) приведены данные о цене на недвижимость где-то в окрестности Сиэтла.

1. Постройте линейную модель, где в качестве независимых переменных выступают «жилая» площадь, `sqft_lot`, `sqft_above` (вместе со свободным коэффициентом), зависимой — цена на недвижимость.

2. Проверьте следующие подозрения:
   - Чем больше «жилая» площадь, тем больше цена
   - Цена зависит от `sqft_lot`
   - Проверьте гипотезу $H_0$ о равенстве одновременно нулю коэффициентов при «жилой» площади и `sqft_above` против альтернативы $H_1 \ne H_0$

#### Задание 2

Для каждого варианта требуется проверить гипотезу о равенстве средних на каждом уровне фактора с помощью модели однофакторного дисперсионного анализа.  
**Указание:** реализовать самим.

В [файле](https://github.com/kihort-si/itmo/blob/main/math%20statistics/lab%204/exams_dataset.csv) представлены данные о сдаче экзаменов.  
Фактор — этническая/национальная группа.  
Выходная переменная — суммарный балл за все три экзамена.
